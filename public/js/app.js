(()=>{"use strict";var e,a={205:()=>{},988:()=>{var e=$('meta[name="csrf-token"]').attr("content"),a=function(a,t){var s=$("#appoint-spiner");$.ajax({url:"slots",type:"post",data:{adate:a,atime:t},headers:{"X-CSRF-TOKEN":e},beforeSend:function(){$(".form-control").removeClass("is-invalid"),s.removeClass("d-none")},complete:function(){s.addClass("d-none")},success:function(e){$("#timeslot-avail").text(e.message)},error:function(e){var a=e.responseJSON;switch(e.status){case 422:var t=a.errors;for(var s in a.message,t)$("#"+s).addClass("is-invalid").next().text(t[s][0]);var n=Object.keys(t)[0];if(n.includes(".")){var r=n.split(".");$("."+r[0]).eq(r[1]).focus()}else $("#"+Object.keys(t)[0]).focus();break;case 404:e.statusText;break;case 500:0}}})},t=function(a,t,s,n,r){var o=$("#appoint-spiner");$.ajax({url:"30c234cc35caba164c8dbd3837a0c55a/pull-slots",type:"post",data:{departmentid:a,transaction_type_id:t,bin:s,adate:n,atime:r},headers:{"X-CSRF-TOKEN":e},beforeSend:function(){$(".form-control").removeClass("is-invalid"),o.removeClass("d-none")},complete:function(){o.addClass("d-none")},success:function(e){$("#timeslot-avail").text(e.message)},error:function(e){var a=e.responseJSON;switch(e.status){case 422:var t=a.errors;for(var s in a.message,t)$("#"+s).addClass("is-invalid").next().text(t[s][0]);var n=Object.keys(t)[0];if(n.includes(".")){var r=n.split(".");$("."+r[0]).eq(r[1]).focus()}else $("#"+Object.keys(t)[0]).focus();break;case 404:e.statusText;break;case 500:0}}})};$(document).ready(function(s){$("body").on("change","#atime",function(e){var t=$("#adate").val(),s=$(this).val();a(t,s)}),$("body").on("input","#adate",function(e){var t=$(this).val(),s=$("#atime").val();a(t,s)}),$("body").on("submit","#master-form",function(a){a.preventDefault(),a.stopPropagation();var t=$(this);$("#departmentid").val(),$("#transaction_type_id").val();if(t.removeClass("was-validated"),$(".form-control").removeClass("is-invalid"),0==t[0].checkValidity())t.addClass("was-validated");else{var s=$("#alert-box-form"),n=$("#btn-submit-appointment"),r=$("#submit-spiner");$.ajax({url:"save",type:"post",data:t.serialize(),headers:{"X-CSRF-TOKEN":e},beforeSend:function(){$(".form-control").removeClass("is-invalid"),s.addClass("d-none"),r.removeClass("d-none"),n.attr("disabled",!0)},complete:function(){r.addClass("d-none"),n.attr("disabled",!1)},success:function(e){var a=e.message,t=e.slot_message;e.error?(s.removeClass("alert-success d-none").addClass("alert-danger").html(a),$("#timeslot-avail").text(t),$(window).scrollTop(0)):(s.removeClass("alert-danger d-none").addClass("alert-success").html(a),$("#timeslot-avail").text(t),$(".aptrefno").text(e.ref_no),$(".aptadate").text(e.adate),$(".aptatime").text(e.atime.split("-")[0].trim()),$(".apttrans").text(e.trans),$(".apteid").text(e.eid),$("#modal-qr-img").attr("src",e.qr_url),$("#as-modal").modal("show"),$("#master-form")[0].reset())},error:function(e){var a,t=e.responseJSON;switch(e.status){case 422:var n=t.errors;for(var r in a=t.message,n)$("#"+r).addClass("is-invalid").parent().find(".invalid-feedback").text(n[r][0]);var o=Object.keys(n)[0];if(o.includes(".")){var i=o.split(".");$("."+i[0]).eq(i[1]).focus()}else $("#"+Object.keys(n)[0]).focus();break;case 404:a=e.statusText;break;case 500:a="Oops! There's something wrong."}$(s).removeClass("alert-success d-none").addClass("alert-danger").text(a),$(window).scrollTop(0)}})}});var n=0;$("body").on("click","#cancel-find-info",function(a){var t=$("#reference_code");if(n=t.val().trim(),t.parent().removeClass("is-invalid"),""==n)t.addClass("is-invalid");else{var s=$("#info-box"),r=$("#alert-box-form"),o=$("#search-spiner"),i=$("#submit-cancel");$.ajax({url:"search-info",type:"post",data:{reference_code:n},headers:{"X-CSRF-TOKEN":e},beforeSend:function(){t.removeClass("is-invalid"),o.removeClass("d-none"),s.addClass("d-none"),r.addClass("d-none")},complete:function(){o.addClass("d-none")},success:function(e){var a=e.message,t=e.fullname;e.error?(s.removeClass("alert-primary d-none").addClass("alert-danger").find("h4").text("Sorry").end().find("p").html(a),i.attr("disabled",!0)):(s.removeClass("alert-danger d-none").addClass("alert-primary").find("h4").text("Hi "+t+",").end().find("p").html(a),i.attr("disabled",!1))},error:function(e){var a,t=e.responseJSON;switch(e.status){case 422:var s=t.errors;for(var n in a=t.message,s)$("#"+n).parent().addClass("is-invalid").next().text(s[n][0]);break;case 404:a=e.statusText;break;case 500:a="Oops! There's something wrong."}$(r).removeClass("alert-success d-none").addClass("alert-danger").text(a)}})}}),$("body").on("click","#submit-cancel",function(a){a.preventDefault(),console.log("✅ Button clicked");var t=$("#alert-box-form"),s=$("#submit-cancel-spiner"),r=$(this);$.ajax({url:"cancel",type:"post",data:{reference_code:n},headers:{"X-CSRF-TOKEN":e},beforeSend:function(){s.removeClass("d-none")},complete:function(){s.addClass("d-none")},success:function(e){e.error?t.removeClass("alert-success d-none").addClass("alert-danger").text(e.message):t.removeClass("alert-danger d-none").addClass("alert-success").text(e.message),r.attr("disabled",!0)},error:function(e){var a,s=e.responseJSON;switch(e.status){case 422:var n=s.errors;for(var r in a=s.message,n)$("#"+r).addClass("is-invalid").next().text(n[r][0]);break;case 404:a=e.statusText;break;case 500:a="Oops! There's something wrong."}$(t).removeClass("alert-success d-none").addClass("alert-danger").text(a)}})}),$("body").on("click","#submit-accept",function(e){e.preventDefault(),$("#reference_codes").val()?$.ajax({url:acceptUrl,type:"POST",data:{reference_code:$("#reference_codes").val(),_token:$('meta[name="csrf-token"]').attr("content")},success:function(e){alert(e.message),e.error||(window.location.href=slotViewerUrl)},error:function(e){console.error("❌ AJAX Error:",e.responseText)}}):alert("Reference code is required")}),$("body").on("submit","#health-mainfrm",function(a){a.preventDefault(),a.stopPropagation();var t=$(this);if(t.removeClass("was-validated"),$(".form-control").removeClass("is-invalid"),$(".custom-feedback").remove(),$("#tbl-yes-no tr").each(function(e,a){0==$(this).find("input:radio").is(":checked")&&$(this).find("td:first-child").append('<div class="invalid-feedback d-block custom-feedback">Please choose whether OO/HINDI.</div>')}),0==t[0].checkValidity())t.addClass("was-validated"),$(".form-control:invalid").eq(0).focus();else{var s=$("#alert-box-form"),n=$("#health-submit-btn"),r=$("#submit-spiner");$.ajax({url:"health/save",type:"post",data:t.serialize(),headers:{"X-CSRF-TOKEN":e},beforeSend:function(){$(".form-control").removeClass("is-invalid"),s.addClass("d-none"),r.removeClass("d-none"),n.attr("disabled",!0)},complete:function(){r.addClass("d-none"),n.attr("disabled",!1)},success:function(e){var a=e.message;e.error?s.removeClass("alert-success d-none").addClass("alert-danger").html(a):s.removeClass("alert-danger d-none").addClass("alert-success").html(a),$(window).scrollTop(0)},error:function(e){var a,t=e.responseJSON;switch(e.status){case 422:var n=t.errors;for(var r in a=t.message,n)$("#"+r).addClass("is-invalid").parent().find(".invalid-feedback").text(n[r][0]);var o=Object.keys(n)[0];if(o.includes(".")){var i=o.split(".");$("."+i[0]).eq(i[1]).focus()}else $("#"+Object.keys(n)[0]).focus();break;case 404:a=e.statusText;break;case 500:a="Oops! There's something wrong."}$(s).removeClass("alert-success d-none").addClass("alert-danger").text(a)}})}}),$("body").on("click",".linked-text",function(e){var a=$(this).attr("name"),t=$(this).data("allow-txt");$("#"+a+"ans").prop("disabled",!t).focus()}),$("body").on("change","#departmentid",function(){var e=$(this).val(),a=$("#transaction_type_id"),t=$("#transaction_spinner");$("#bin, #business_name").toggleClass("d-none",2!=e&&23!=e),$(".department-alert-active").addClass("d-none").removeClass(".department-alert-active"),$(".department-alert[data-alert-id="+e+"]").addClass(".department-alert-active").removeClass("d-none"),$.ajax({url:"dropdowns/transaction-types?department_id="+e,beforeSend:function(){a.prop("disabled",!0),t.removeClass("d-none")},complete:function(){a.prop("disabled",!1),t.addClass("d-none")},success:function(e){for(var a=e.results.length,t=0;t<a;t++)e.results[t].id,e.results[t].text}})}),$("#cancel-find-infos").on("click",function(e){e.preventDefault();var a=$("#reference_codes").val().trim();if(""===a)return alert("Please enter a reference code before searching."),!1;window.open(verificationUrl+"/"+a,"_self")});var r=$("#transaction_type_id").data("old");r&&($("#departmentid").change(function(e,a){setTimeout(function(){"function"==typeof a&&a()},800)}),$("#departmentid").trigger("change",function(){$("#transaction_type_id").val(r),$("#transaction_type_id").trigger("change")})),$("body").on("change","#walk_in_atime",function(e){var a=$("#walk_in_adate").val(),s=$(this).val(),n=$("#departmentid").val(),r=$("#transaction_type_id").val(),o=$("#bin").val();t(n,r,o,a,s)}),$("body").on("input","#walk_in_adate",function(e){var a=$(this).val(),s=$("#walk_in_atime").val(),n=$("#departmentid").val(),r=$("#transaction_type_id").val(),o=$("#bin").val();t(n,r,o,a,s)}),$("body").on("change","#transaction_type_id",function(e){var a=$(this).val();console.log(a);var t=$("#bin"),s=$("#business_name");8==a||16==a?(t.closest(".input-group").addClass("d-none"),s.prop("readonly",!1)):(t.closest(".input-group").removeClass("d-none"),s.prop("readonly",!0))})});var s={};$("#adate").on("change",function(){var e=$(this).val();if(!e)return $("#slot-remaining").text(""),void $("#atime").empty();$.ajax({url:window.remainingCountsUrl,type:"GET",data:{adate:e},success:function(e){s={};var a=$("#atime");a.empty(),$.each(e,function(e,t){var n=t.timeslot.trim(),r=n.split("-")[0].trim();s[n]=t.Remaining,a.append('<option value="'.concat(n,'">').concat(r,"</option>"))}),a.trigger("change")},error:function(){console.error("Failed to fetch remaining counts")}})}),$("#atime").on("change",function(){var e=$(this).val();void 0!==s[e]?$("#slot-remaining").text("(".concat(s[e]," slots left)")):$("#slot-remaining").text("")}),$.ajax({url:window.timeslotsUrl,type:"GET",success:function(e){var a=$("#atime");a.empty(),$.each(e,function(e,t){var s=t.timeslot.split("-")[0].trim();a.append('<option value="'.concat(s,'">').concat(s,"</option>"))}),a.trigger("change")},error:function(){console.error("Failed to load timeslots")}}),$(".use-daterangepicker").each(function(){$(this).daterangepicker()}),$("#sdate").on("change",function(){var e=$(this).val();window.currentRequest&&window.currentRequest.abort();var a=$("#slot-list");a.empty().append('<li class="list-group-item">Loading...</li>'),window.currentRequest=$.ajax({url:window.slotviewerUrl,type:"GET",data:{sdate:e},dataType:"json",success:function(e){a.empty(),e.count.length>0?$.each(e.count,function(e,t){a.append('\n                        <li class="list-group-item d-flex justify-content-between align-items-center">\n                            <h4>'.concat(t.atime.split("-")[0].trim(),'</h4>\n                            <span class="badge badge-primary badge-pill">\n                                <h4><strong>').concat(t.Total,"</strong></h4>\n                            </span>\n                        </li>\n                    "))}):a.append('<li class="list-group-item">No appointments found</li>');var t=null!==e.total&&void 0!==e.total?e.total:0;$("#grand-total").text(t)},error:function(e,a,t){"abort"!==a&&console.error("Error:",t)}})})}},t={};function s(e){var n=t[e];if(void 0!==n)return n.exports;var r=t[e]={exports:{}};return a[e](r,r.exports,s),r.exports}s.m=a,e=[],s.O=(a,t,n,r)=>{if(!t){var o=1/0;for(c=0;c<e.length;c++){for(var[t,n,r]=e[c],i=!0,l=0;l<t.length;l++)(!1&r||o>=r)&&Object.keys(s.O).every(e=>s.O[e](t[l]))?t.splice(l--,1):(i=!1,r<o&&(o=r));if(i){e.splice(c--,1);var d=n();void 0!==d&&(a=d)}}return a}r=r||0;for(var c=e.length;c>0&&e[c-1][2]>r;c--)e[c]=e[c-1];e[c]=[t,n,r]},s.o=(e,a)=>Object.prototype.hasOwnProperty.call(e,a),(()=>{var e={847:0,252:0};s.O.j=a=>0===e[a];var a=(a,t)=>{var n,r,[o,i,l]=t,d=0;if(o.some(a=>0!==e[a])){for(n in i)s.o(i,n)&&(s.m[n]=i[n]);if(l)var c=l(s)}for(a&&a(t);d<o.length;d++)r=o[d],s.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return s.O(c)},t=self.webpackChunk=self.webpackChunk||[];t.forEach(a.bind(null,0)),t.push=a.bind(null,t.push.bind(t))})(),s.O(void 0,[252],()=>s(988));var n=s.O(void 0,[252],()=>s(205));n=s.O(n)})();